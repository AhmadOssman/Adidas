'use strict';mix_d("CerberusSharedCards__cerberus-shared:cerberus-shared__XnUGSpDT","require exports tslib @p/A @c/metrics @c/aui-truncate @c/aui-utils @c/logger @c/pagemarker @c/remote-operations @c/scoped-dom @c/tracking @c/aui-feature-detect".split(" "),function(aa,ba,z,la,U,ma,na,u,oa,pa,qa,V,ra){function F(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}function ca(a){if(a&&a.__esModule)return a;var c=Object.create(null);a&&Object.keys(a).forEach(function(b){if("default"!==b){var d=
Object.getOwnPropertyDescriptor(a,b);Object.defineProperty(c,b,d.get?d:{enumerable:!0,get:function(){return a[b]}})}});c["default"]=a;return c}var E=F(la),f=F(U),sa=F(ma),ta=F(na),da=F(oa),ua=F(pa),K=F(qa),va=F(ra),ea={},W=function(a,c,b){void 0===c&&(c="");void 0===b&&(b=1);c=a+c;ea.hasOwnProperty(c)||(ea[c]=!0,U.count(a,(U.count(a)||0)+b))},wa=function(a){W(E["default"].capabilities.mobile?"Card:EERU:SharedLib:mobile:render":"Card:EERU:SharedLib:desktop:render");var c=function(d,e){d={$event:{preventDefault:E["default"].$.noop,
stopPropagation:E["default"].$.noop},$target:d.getContent().find('[data-a-tab-name="'+e+'"]'),data:{name:"energyEfficiencyTabSet"}};E["default"].trigger("a:declarative:a-tabs:click",d)},b=function(d,e){var h=d&&d.$event,m=d&&d.data||{},p=m.activeTabName,l=m.modalHeight,r=m.name;h&&h.preventDefault&&h.preventDefault();h&&h.stopPropagation&&h.stopPropagation();h=e.get(r);h||(E["default"].on("a:popover:beforeShow:"+r,function(k){k.popover&&k.popover.getContent&&(k=k.popover.getContent(),k.find(".a-manually-loaded").parent().css("min-height",
l),E["default"].loadDescendantImagesManually(k))}),h=e.create(d.$target,m));h.show();c(h,p)};a.when("a-secondary-view").execute("RegisterEnergyEfficiencyEventMobile",function(d){E["default"].declarative("card-energy-efficiency-secondary-view","click",function(e){W("Card:EERU:SharedLib:mobile:click",e&&e.data&&e.data.name||"");b(e,d)})});a.when("a-modal").execute("RegisterEnergyEfficiencyEventDesktop",function(d){E["default"].declarative("card-energy-efficiency-modal","click",function(e){W("Card:EERU:SharedLib:desktop:click",
e&&e.data&&e.data.name||"");b(e,d)})})},xa=function(a){a.when("ready").execute("EEBadgeProductFicheResize",function(c){var b=E["default"].$;b(".energyEfficiencyContainer").each(function(d,e){d=b(e).find(".energyEfficiencyProductFicheLabel").first();e=b(e).find("svg").first();d.parent().outerHeight()>e.outerHeight()&&(d.removeClass("a-size-small"),d.addClass("a-size-micro"),d.parent().outerHeight()>e.outerHeight()&&d.parent().css("line-height","10px"))})})},ya=function(){var a=window.P;wa(a);xa(a)},
S={wb:1},za=function(a){return{subsAsin:a.asin,subsAvgRating:a.reviewRating,subsCurrency:a.currencyCode,subsHighestPrice:parseFloat(a.priceRangeHigh||"")||void 0,subsIsParent:a.isParent,subsIsPrime:a.isPrime,subsIsPrimeBadgeLazy:a.isPrimeBadgeLazyEnabled,subsLowestPrice:parseFloat(a.priceRangeLow||"")||void 0,subsPosition:a.position-1,subsPrice:parseFloat(a.price||"")||0,subsPrimeEligible:a.isPrime,subsSourcesMap:a.substituteSourcesMap,subsTotalReviews:a.reviewCount,subsSource:null,subsSourceScore:null}},
Aa=function(){f["default"].count("rsi.crb.dpmark.reg.auical",1);P.now("injectCalendarOnDetailPage").execute("cerberusSharedCardsAuiCalendarRegisterDpMarker",function(a){if(!a)try{P.register("injectCalendarOnDetailPage",function(){var c;return c={},c.injectCalendarOnDetailPage=1,c})}catch(c){}})},X=function(a,c,b){c=encodeURIComponent(c);a.classList.add("a-declarative");a.setAttribute("data-action",c);a.setAttribute("data-"+c.toLowerCase(),JSON.stringify(b))},fa=function(a,c,b){c=encodeURIComponent(c);
a.setAttribute("data-"+c.toLowerCase(),JSON.stringify(b))},ha=function(a,c){return{asin:c,buyingRuleId:a,existingRuleRedirectView:"delete",existingRuleTerminatedRedirectView:"edit",minFormActions:"true",noRuleRedirectToCreateAsin:c,source:"dpoosw"}},ia=function(a,c){return{asin:c,buyingRuleId:a,existingRuleRedirectView:"delete",existingRuleTerminatedRedirectView:"edit",minFormActions:"true",noRuleRedirectToCreateAsin:c,source:"dpoosw"}},Ba=function(){f["default"].count("rsi.crb.dpmark.reg.brdp",1);
P.now("useBuyingRulesDpAssets").execute("cerberusSharedCardsBuyingRulesCxRegisterDpMarker",function(a){if(!a)try{P.register("useBuyingRulesDpAssets",function(){return{useBuyingRulesDpAssets:1}})}catch(c){}})},Ca=function(a){f["default"].count("rsi.crb.brx.setup.pending",1);P.when("brx-dp-app-behavior").execute("cerberusSharedCardsBuyingRulesCx",function(c){f["default"].count("rsi.crb.brx.setup.start",1);var b=c.eventNames,d=c.viewNames,e=a.pageAsin;if(e){var h=K["default"].cardRoot.getElementsByClassName("_cerberus-shared_identifiers_idWidgetSubTitle__2fmXg")[0];
if(h){var m=K["default"].cardRoot.getElementsByClassName("_cerberus-shared_identifiers_idBuyingRuleSubTitleCreate__RX7tg")[0],p=K["default"].cardRoot.getElementsByClassName("_cerberus-shared_identifiers_idBuyingRuleSubTitleDelete__1jzas")[0],l=K["default"].cardRoot.getElementsByClassName("_cerberus-shared_identifiers_idBuyingRuleSubTitleEdit__aFklQ")[0];if(m&&p&&l){m=m.getElementsByTagName("a")[0];var r=p.getElementsByTagName("a")[0],k=l.getElementsByTagName("a")[0];if(m&&r&&k){var v=function(g){g===
d.CREATE_BUYING_RULE_VIEW_NAME?h.setAttribute("data-buyingruleaction","create"):g===d.DELETE_BUYING_RULE_VIEW_NAME?h.setAttribute("data-buyingruleaction","delete"):g===d.EDIT_BUYING_RULE_VIEW_NAME&&h.setAttribute("data-buyingruleaction","edit")};p=c.localizedDataManager;p.setLocale(a.language,a.currency);l=a.localizedStrings;"object"===typeof l&&l?p.assignStrings(l):(u.log("CerberusSharedCards.BRX.Setup.strings not found in data attributes for asin("+e+")","ERROR"),f["default"].count("rsi.crb.brx.setup.nostrings",
1));l=p.getString("create-buying-rule--a-modal--option--header");var C={ajaxFailMsg:p.getString("create-buying-rule--view--load-failed--message"),closeMessage:p.getString("a-sheet--option--generic--closeMessage"),header:l,popoverLabel:l,sheetLabel:l};l=p.getString("delete-buying-rule--a-modal--option--header");var n={ajaxFailMsg:p.getString("delete-buying-rule--view--load-failed--message"),closeMessage:p.getString("a-sheet--option--generic--closeMessage"),header:l,popoverLabel:l,sheetLabel:l};l=p.getString("edit-buying-rule--a-modal--option--header");
var A={ajaxFailMsg:p.getString("edit-buying-rule--view--load-failed--message"),closeMessage:p.getString("a-sheet--option--generic--closeMessage"),header:l,popoverLabel:l,sheetLabel:l};c.addHook_SHOW_VIEW_BEFORE_SHOW_LOCALIZE_VIEW(d.CREATE_BUYING_RULE_VIEW_NAME,function(g){g.updateViewLanguage(d.CREATE_BUYING_RULE_VIEW_NAME,C);v(d.CREATE_BUYING_RULE_VIEW_NAME)});c.addHook_SHOW_VIEW_BEFORE_SHOW_LOCALIZE_VIEW(d.DELETE_BUYING_RULE_VIEW_NAME,function(g){g.updateViewLanguage(d.DELETE_BUYING_RULE_VIEW_NAME,
n);v(d.DELETE_BUYING_RULE_VIEW_NAME)});c.addHook_SHOW_VIEW_BEFORE_SHOW_LOCALIZE_VIEW(d.EDIT_BUYING_RULE_VIEW_NAME,function(g){g.updateViewLanguage(d.EDIT_BUYING_RULE_VIEW_NAME,A);v(d.EDIT_BUYING_RULE_VIEW_NAME)});c.addHook_SHOW_VIEW_REDIRECT_LOCALIZE_VIEW(d.CREATE_BUYING_RULE_VIEW_NAME,function(g,w,t,q){g.updateViewLanguage(d.CREATE_BUYING_RULE_VIEW_NAME,C);v(t)});c.addHook_SHOW_VIEW_REDIRECT_LOCALIZE_VIEW(d.DELETE_BUYING_RULE_VIEW_NAME,function(g,w,t,q){g.updateViewLanguage(d.DELETE_BUYING_RULE_VIEW_NAME,
n);v(t)});c.addHook_SHOW_VIEW_REDIRECT_LOCALIZE_VIEW(d.EDIT_BUYING_RULE_VIEW_NAME,function(g,w,t,q){g.updateViewLanguage(d.EDIT_BUYING_RULE_VIEW_NAME,A);v(t)});X(m,"brx-create-buying-rule-view",{buyingRuleId:a.buyingRuleId,asin:e,minFormActions:"true",existingRuleRedirectView:"delete",existingRuleTerminatedRedirectView:"edit",source:"dpoosw"});X(r,"brx-delete-buying-rule-view",ha(a.buyingRuleId,e));X(k,"brx-edit-buying-rule-view",ia(a.buyingRuleId,e));var y=!1;"create"===a.buyingRuleInitialAction?
f["default"].count("rsi.crb.brx.initial.create.show",1):"delete"===a.buyingRuleInitialAction?f["default"].count("rsi.crb.brx.initial.delete.show",1):"edit"===a.buyingRuleInitialAction&&f["default"].count("rsi.crb.brx.initial.edit.show",1);m.addEventListener("click",function(g){f["default"].count("rsi.crb.brx.create.click",1);y||"create"!==a.buyingRuleInitialAction||(y=!0,f["default"].count("rsi.crb.brx.initial.create.click",1))});r.addEventListener("click",function(g){f["default"].count("rsi.crb.brx.delete.click",
1);y||"delete"!==a.buyingRuleInitialAction||(y=!0,f["default"].count("rsi.crb.brx.initial.delete.click",1))});k.addEventListener("click",function(g){f["default"].count("rsi.crb.brx.edit.click",1);y||"edit"!==a.buyingRuleInitialAction||(y=!0,f["default"].count("rsi.crb.brx.initial.edit.click",1))});c.eventManager.subscribe([b.CREATE_BUYING_RULE_FORM_SEND_SUCCESS_EVENT,b.DEACTIVATE_BUYING_RULE_FORM_SEND_SUCCESS_EVENT,b.EDIT_BUYING_RULE_FORM_SEND_SUCCESS_EVENT],function(g,w){var t;if((null===(t=null===
g||void 0===g?void 0:g.buyingRuleModel)||void 0===t?void 0:t.asin)===e){t=g.buyingRuleModel.id;g=g.buyingRuleModel.isTerminated;fa(r,"brx-delete-buying-rule-view",ha(t,e));fa(k,"brx-edit-buying-rule-view",ia(t,e));var q=r.setAttribute;var D="/buying-rules?ref_="+encodeURIComponent("mobile"===a.deviceType?"rsi_br_brh_dpoosw_dbrl_mawd":"rsi_br_brh_dpoosw_dbrl_dstd")+"&action="+encodeURIComponent("delete-br")+"&source=dpoosw&buyingRuleId="+encodeURIComponent(t)+"&noRuleRedirectToCreateAsin="+encodeURIComponent(e||
"")+"&existingRuleRedirectView=delete&existingRuleTerminatedRedirectView=edit&minFormActions=true";q.call(r,"href",D);q=k.setAttribute;t="/buying-rules?ref_="+encodeURIComponent("mobile"===a.deviceType?"rsi_br_brh_dpoosw_ebrl_mawd":"rsi_br_brh_dpoosw_ebrl_dstd")+"&action="+encodeURIComponent("edit-br")+"&source=dpoosw&buyingRuleId="+encodeURIComponent(t)+"&noRuleRedirectToCreateAsin="+encodeURIComponent(e||"")+"&existingRuleRedirectView=delete&existingRuleTerminatedRedirectView=edit&minFormActions=true";
q.call(k,"href",t);v(g?d.EDIT_BUYING_RULE_VIEW_NAME:d.DELETE_BUYING_RULE_VIEW_NAME);w===b.CREATE_BUYING_RULE_FORM_SEND_SUCCESS_EVENT?f["default"].count("rsi.crb.brx.create.complete",1):(w===b.EDIT_BUYING_RULE_FORM_SEND_SUCCESS_EVENT||w===b.DEACTIVATE_BUYING_RULE_FORM_SEND_SUCCESS_EVENT)&&f["default"].count("rsi.crb.brx.edit.complete",1)}});c.eventManager.subscribe(b.DELETE_BUYING_RULE_FORM_SEND_SUCCESS_EVENT,function(g){var w;(null===(w=null===g||void 0===g?void 0:g.buyingRuleModel)||void 0===w?void 0:
w.asin)===e&&(v(d.CREATE_BUYING_RULE_VIEW_NAME),f["default"].count("rsi.crb.brx.delete.complete",1))});f["default"].count("rsi.crb.brx.setup.end",1)}else u.log("CerberusSharedCards.BRX.Setup.create/delete/edit link element not found for asin("+e+")","FATAL"),f["default"].count("rsi.crb.brx.setup.error",1)}else u.log("CerberusSharedCards.BRX.Setup.create/delete/edit sub title element not found for asin("+e+")","FATAL"),f["default"].count("rsi.crb.brx.setup.error",1)}else u.log("CerberusSharedCards.BRX.Setup.widget sub title element not found for asin("+
e+")","FATAL"),f["default"].count("rsi.crb.brx.setup.error",1)}else u.log("CerberusSharedCards.BRX.Setup.page asin not found in data attributes","FATAL"),f["default"].count("rsi.crb.brx.setup.error",1)})},Da=function(a){return z.__awaiter(void 0,void 0,void 0,function(){var c,b;return z.__generator(this,function(d){switch(d.label){case 0:return va["default"].isSupported("isAmazonApp")?[4,new Promise(function(e,h){aa(["@m/mash"],function(m){e(ca(m))},h)})]:[3,2];case 1:return c=d.sent(),c.cart.didUpdate({newCartQuantity:a}),
[3,4];case 2:return[4,new Promise(function(e,h){aa(["@p/nav.setCartCount"],function(m){e(ca(m))},h)})];case 3:b=d.sent(),b.default(a),d.label=4;case 4:return[2]}})})},Y=function(a,c,b,d){var e="none",h="none",m="none";"undefined"===typeof d?e="block":d?h="block":m="block";a&&(a.style.display=e);c&&(c.style.display=h);b&&(b.style.display=m)},Ea=function(a){var c={cssGlobalClassName:"cerberusSharedCards-deviceTypeUnknown",isDesktop:!1,isMobile:!1,isTablet:!1,isUnknown:!1,metrics:{counterSuffix:".unknown"},
origType:a,type:"unknown"};"desktop"===a?(c.cssGlobalClassName="cerberusSharedCards-deviceTypeDesktop",c.isDesktop=!0,c.type="desktop",c.metrics.counterSuffix=".desktop"):"mobile"===a?(c.cssGlobalClassName="cerberusSharedCards-deviceTypeMobile",c.isMobile=!0,c.type="mobile",c.metrics.counterSuffix=".mobile"):"tablet"===a?(c.cssGlobalClassName="cerberusSharedCards-deviceTypeTablet",c.isTablet=!0,c.type="tablet",c.metrics.counterSuffix=".tablet"):c.isUnknown=!0;return c},Fa=function(a){if("object"!==
typeof a||!a)throw Error("ASIN faceout element is not valid");a=a.dataset;return{asin:a.asin||"",currencyCode:a.currencycode||"",hasPriceRange:"true"===a.haspricerange,isMapSuppressed:"true"===a.ismapsuppressed,isParent:"true"===a.isparent,isPrime:"true"===a.isprime,isPrimeBadgeLazyEnabled:"true"===a.isprimebadgelazyenabled,offerListingId:a.offerlistingid,position:Number(a.position)||-1,price:a.price||"",priceRangeHigh:a.pricerangehigh,priceRangeLow:a.pricerangelow,reviewCount:Number(a.reviewcount)||
0,reviewRating:parseFloat(a.reviewrating||"")||0,substituteSourcesMap:a.substitutesourcesmap}},Ga=function(a){if("object"!==typeof a||!a)throw Error("Widget data element is not valid");a=a.dataset;var c=a.requestid,b=a.widgettype,d=a.widgettypevariant;if(!b||!c)throw Error("Required data attributes not found");return{buyingRuleId:a.buyingruleid,buyingRuleInitialAction:a.buyingruleinitialaction,currency:a.currency||"",customerId:a.customerid,deviceType:a.devicetype||"unknown",displayReason:a.displayreason||
"UNKNOWN",isBuyingRuleTerminated:a.isbuyingruleterminated?"true"===a.isbuyingruleterminated:void 0,isBuyingRulesEnabled:"true"===a.isbuyingrulesenabled,isBuyingRulesReminderCxEnabled:"true"===a.isbuyingrulesremindercxenabled,isBuyingRulesStringCxEnabled:"true"===a.isbuyingrulesstringcxenabled,isLazyPrimeBadgeEnabled:"true"===a.islazyprimebadgeenabled,language:a.language||"",localizedStrings:a.localizedstrings?JSON.parse(a.localizedstrings):{},marketplaceId:a.marketplaceid||"",pageAsin:a.pageasin,
producerId:a.producerid,reftag:a.reftag||"",renderPageType:a.renderpagetype||"unknown",requestId:c,sessionId:a.sessionid||"",widgetType:b,widgetTypeVariant:d||"None"}},Ha=function(a,c,b){b={cssGlobalClassName:"cerberusSharedCards-widgetTypeUnknown",isCart:!1,isCnsw:!1,isCompatibleProducts:!1,isFlex:!1,isFod:!1,isGemini:!1,isLpo:!1,isLpoFreeSearchVariant:!1,isLpoShoppingAdsVariant:!1,isOos:!1,isOosGlanceViewVariant:!1,isUnknown:!1,metrics:{typeClientCounter:"prs.crb.clnt.env.wgt.unknown",typeServerCounter:"prs.crb.srv.env.wgt.unknown",
typeVariantClientCounter:"prs.crb.clnt.env.wgt.var.none",typeVariantServerCounter:"prs.crb.srv.env.wgt.var.none"},origDisplayReason:b,type:a||"Unknown",typeVariant:"None"};"Cart"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeCart",b.isCart=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.cart",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.cart"):"Cnsw"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeCnsw",b.isCnsw=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.cnsw",
b.metrics.typeServerCounter="prs.crb.srv.env.wgt.cnsw"):"CompatibleProducts"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeCompatibleProducts",b.isCompatibleProducts=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.compatible-products",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.compatible-products"):"Flex"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeFlex",b.isFlex=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.flex",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.flex"):
"Fod"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeFod",b.isFod=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.fod",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.fod"):"Gemini"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeGemini",b.isGemini=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.gemini",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.gemini"):"Lpo"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeLpo",b.isLpo=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.lpo",
b.metrics.typeServerCounter="prs.crb.srv.env.wgt.lpo","LpoFreeSearch"===c?(b.isLpoFreeSearchVariant=!0,b.typeVariant=c,b.metrics.typeVariantClientCounter="prs.crb.clnt.env.wgt.var.lpo-free-search",b.metrics.typeVariantServerCounter="prs.crb.srv.env.wgt.var.lpo-free-search"):"LpoShoppingAds"===c&&(b.isLpoShoppingAdsVariant=!0,b.typeVariant=c,b.metrics.typeVariantClientCounter="prs.crb.clnt.env.wgt.var.lpo-shopping-ads",b.metrics.typeVariantServerCounter="prs.crb.srv.env.wgt.var.lpo-shopping-ads")):
"Oos"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeOos",b.isOos=!0,b.metrics.typeClientCounter="prs.crb.clnt.env.wgt.oos",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.oos","OosGlanceView"===c&&(b.isOosGlanceViewVariant=!0,b.typeVariant=c,b.metrics.typeVariantClientCounter="prs.crb.clnt.env.wgt.var.oos-glance-view",b.metrics.typeVariantServerCounter="prs.crb.srv.env.wgt.var.oos-glance-view")):"Odp"===a?(b.cssGlobalClassName="cerberusSharedCards-widgetTypeOdp",b.metrics.typeClientCounter=
"prs.crb.clnt.env.wgt.odp",b.metrics.typeServerCounter="prs.crb.srv.env.wgt.odp"):(b.cssGlobalClassName="cerberusSharedCards-widgetTypeUnknown",b.isUnknown=!0,b.type="Unknown");return b},Ia=function(a,c,b){var d,e=b.producerId;if(e){var h=b.customerId||null,m=b.marketplaceId,p=b.sessionId,l=b.requestId,r={deviceType:b.deviceType,seedAsin:b.pageAsin,subsReason:b.displayReason};c=function(n){var A=n.imageLinkElement,y=n.titleLinkElement,g=za(n.dataAttributes);g=z.__assign(z.__assign({customerId:h,obfuscatedMarketplaceId:m,
sessionId:p},r),g);f["default"].event(g,e,"prservices.SurfacedSubstituteEvent.6");var w=z.__assign({customerId:h,obfuscatedMarketplaceId:m,sessionId:p,subsAsin:n.asin,surfacedAsinRequestId:l},r);y?y.addEventListener("click",function(){f["default"].event(w,e,"prservices.ClickedSubstituteEvent.4")}):u.log("CerberusSharedCards.MissingElement.titleLink not found; asin: "+n.asin,"ERROR");A?A.addEventListener("click",function(){f["default"].event(w,e,"prservices.ClickedSubstituteEvent.4")}):u.log("CerberusSharedCards.MissingElement.imageLink not found; asin: "+
n.asin,"ERROR")};try{for(var k=z.__values(a),v=k.next();!v.done;v=k.next())c(v.value)}catch(n){var C={error:n}}finally{try{v&&!v.done&&(d=k.return)&&d.call(k)}finally{if(C)throw C.error;}}}else c.isCart||c.isLpo||u.log("CerberusSharedCards.NexusLogging.producerId not found","WARN")},Ja=function(a,c,b,d,e){var h,m,p=c.reftag;if((b.isCart||b.isCompatibleProducts)&&a.length){var l=!1;try{for(var r=z.__values(a),k=r.next();!k.done;k=r.next()){var v=k.value;if(v.cartActionContainerElement){l=!0;break}}}catch(q){var C=
{error:q}}finally{try{k&&!k.done&&(h=r.return)&&h.call(r)}finally{if(C)throw C.error;}}if(l){var n=b.isCart?"rsi.cart.":"rsi.oos.";f["default"].count(""+n+"atc.shown."+d,1);var A=-1;b=function(q){A++;var D=q.asin,R=q.dataAttributes.offerListingId;q=q.cartActionContainerElement;if(!q)return u.log("CerberusSharedCards.ATC.Cart action container not found; asin: "+D+"; pageAsin: "+c.pageAsin,"ERROR"),"continue";var L=p+"_oos_atcajx_"+d+"_"+A,G=p+"_oos_cartajx_"+d+"_"+A,O=q.querySelector("button");if(!O)return u.log("CerberusSharedCards.FindATCButton.Does not exist; asin: "+
D+"; pageAsin: "+c.pageAsin,"ERROR"),{value:void 0};if(!D||!R)return u.log("CerberusSharedCards.ATC.No offer listing ID to add to cart; asin: "+D+"; pageAsin: "+c.pageAsin),O.style.visibility="hidden","continue";var M=q.querySelector("._cerberus-shared_asinFaceoutCartAction_afCartActionMessageLoading__NgVU3"),Q=q.querySelector("._cerberus-shared_asinFaceoutCartAction_afCartActionMessageSuccess__1Kidz"),T=q.querySelector("._cerberus-shared_asinFaceoutCartAction_afCartActionMessageFail__2tBPW");O.addEventListener("click",
function(){return z.__awaiter(void 0,void 0,void 0,function(){var x,H,I,J,N;return z.__generator(this,function(B){switch(B.label){case 0:f["default"].count(""+n+"atc.click."+d,1),Y(M,Q,T,void 0),B.label=1;case 1:return B.trys.push([1,3,,4]),x={asin:D,offerListingId:R},[4,V.addTracking(e.addToCart,{},L||"")(x)];case 2:return B.sent(),[3,4];case 3:return H=B.sent(),u.log("CerberusSharedCards.ATC."+H.toString()+"; asin: "+D,"ERROR"),f["default"].count(""+n+"atc.fail."+d,1),Y(M,Q,T,!1),[2];case 4:f["default"].count(""+
n+"atc.success."+d,1),I=null,B.label=5;case 5:return B.trys.push([5,7,,8]),[4,V.addTracking(e.getCartCount,{},G||"")()];case 6:return I=B.sent(),[3,8];case 7:return J=B.sent(),u.log("CerberusSharedCards.getCartCount."+J.toString()+"; asin: "+D,"ERROR"),f["default"].count(""+n+"gcc.fail."+d,1),[2];case 8:return f["default"].count(""+n+"gcc.success."+d,1),Y(M,Q,T,!0),[4,Da(I.items)];case 9:return B.sent(),N=K["default"].cardRoot.getElementsByClassName("_cerberus-shared_identifiers_idAddToCartClickedFlag__rhlYt"),
0<N.length&&N[0].setAttribute("value","true"),[2]}})})})};try{for(var y=z.__values(a),g=y.next();!g.done;g=y.next()){v=g.value;var w=b(v);if("object"===typeof w)return w.value}}catch(q){var t={error:q}}finally{try{g&&!g.done&&(m=y.return)&&m.call(y)}finally{if(t)throw t.error;}}}else u.log("CerberusSharedCards.ATC.No cart action containers found for cart widget when items shown; pageAsin: "+c.pageAsin,"ERROR")}};ba._operationNames=["addToCart","getCartCount","getPrimeBadge"];ba.card=function(){return z.__awaiter(void 0,
void 0,void 0,function(){var a,c,b,d,e,h,m,p,l,r,k,v,C,n,A,y,g,w,t,q,D,R,L,G,O,M,Q;return z.__generator(this,function(T){a=Date.now();c=!1;try{f["default"].count("prs.crb.clnt.eval.begin",1);f["default"].uet("bb","cerberus-shared",S);b=ua["default"].setup();try{d=Ga(K["default"].cardRoot.getElementsByClassName("_cerberus-shared_identifiers_idWidgetData__13wSW")[0])}catch(x){throw u.log("CerberusSharedCards.WidgetData."+x.message,"ERROR"),f["default"].count("rsi.gwdata.fail",1),f["default"].count("prs.crb.clnt.eval.fail.data-input",
1),c=!0,x;}e=d.deviceType||"unknown";h=Ha(d.widgetType,d.widgetTypeVariant);m=Ea(e);p=d.renderPageType;f["default"].count(h.metrics.typeClientCounter,1);f["default"].count(h.metrics.typeVariantClientCounter,1);f["default"].count(""+h.metrics.typeClientCounter+m.metrics.counterSuffix,1);f["default"].count(""+h.metrics.typeVariantClientCounter+m.metrics.counterSuffix,1);h.isOos?f["default"].count("prservices.ooswidget.shown."+e,1):h.isFod?f["default"].count("prservices.fodwidget.shown."+e,1):h.isCnsw?
f["default"].count("prservices.cnswwidget.shown."+e,1):h.isCart?sa["default"].refreshAutoTruncate():"Odp"===d.widgetType&&f["default"].count("prservices.odpwidget.client.time",Date.now()-a);l=K["default"].cardRoot.getElementsByClassName("_cerberus-shared_identifiers_idAsinFaceoutContainer__1tA-V");r=[];k=[];v=[];for(C=0;C<l.length;C++)n=l[C],A=Fa(n),y=A.asin,g=n.getElementsByClassName("_cerberus-shared_identifiers_idAsinFaceoutImageLink__2gOXw")[0],w=A.isPrimeBadgeLazyEnabled?n.getElementsByClassName("_cerberus-shared_identifiers_idAsinFaceoutLazyPrimeBadge__3MnZp")[0]:
void 0,t={asin:y,cartActionContainerElement:n.getElementsByClassName("_cerberus-shared_identifiers_idAsinFaceoutCartActionContainer__2iTcx")[0],containerElement:n,dataAttributes:A,imageElement:null===g||void 0===g?void 0:g.getElementsByTagName("img")[0],imageLinkElement:g,lazyPrimeBadgeElement:w,titleLinkElement:n.getElementsByClassName("_cerberus-shared_identifiers_idAsinFaceoutTitleLink__3_7-h")[0]},r.push(t),w&&(v.push(y),k.push(t));!d.isLazyPrimeBadgeEnabled&&k.length&&u.log("CerberusSharedCards.UnexpectedState.lazyPrimeBadges found when not enabled",
"ERROR");Ja(r,d,h,e,b);f["default"].uet("cf","cerberus-shared",S);q=function(){f["default"].uet("be","cerberus-shared",S);Ia(r,h,d);f["default"].uex("ld","cerberus-shared",S)};0<k.length?(D=V.addTracking(b.getPrimeBadge),D(v).then(function(x){var H;try{for(var I=z.__values(k),J=I.next();!J.done;J=I.next()){var N=J.value,B=N.asin,ja=N.containerElement,Z=N.lazyPrimeBadgeElement;Z?x[B]?(Z.classList.remove("_cerberus-shared_utilities_hidden__2mxOy"),ja.dataset.isPrime="true"):(Z.classList.add("_cerberus-shared_utilities_hidden__2mxOy"),
ja.dataset.isPrime="false"):u.log("CerberusSharedCards.MissingElement.lazyPrimeBadge not found; asin: "+B+"; isPrime: "+x[B],"ERROR")}}catch(Ka){var ka={error:Ka}}finally{try{J&&!J.done&&(H=I.return)&&H.call(I)}finally{if(ka)throw ka.error;}}}).catch(function(x){u.log("CerberusSharedCards.getPrimeBadge failed: "+x,"ERROR")}).then(function(){return q()})):q();R=function(x){var H=x.imageElement;H?da["default"].pageLoad.then(function(){return ta["default"].loadDynamicImage(H)}):u.log("CerberusSharedCards.MissingElement.image not found; asin: "+
x.asin,"ERROR")};try{for(L=z.__values(r),G=L.next();!G.done;G=L.next())O=G.value,R(O)}catch(x){M={error:x}}finally{try{G&&!G.done&&(Q=L.return)&&Q.call(L)}finally{if(M)throw M.error;}}ya();d.isBuyingRulesReminderCxEnabled&&(f["default"].count("rsi.crb.brx.setup.init",1),da["default"].pageReady.then(function(){"object"===typeof P?"dp"===p?P.when("dp-time-to-interactive").execute("cerberusSharedCardsBuyingRulesCxMarkerWait",function(x){x.getClickToCIPromise().then(function(){Aa();Ba();Ca(d)})}):u.log("Buying Rules CX loaded on non-DP page; renderPageType: "+
d.renderPageType+"; displayReason: "+d.displayReason+"; reftag: "+d.reftag+";","FATAL"):u.log("P global not found when enabling Buying Rules CX; asin: "+d.pageAsin,"FATAL")}));f["default"].count("prs.crb.clnt.eval.end",1)}catch(x){throw c||(u.log("Top level error in client.ts: "+x.message,"FATAL"),f["default"].count("prs.crb.clnt.eval.fail.unknown",1)),x;}return[2]})})}});
